"use strict";import{Fragment as B,jsx as g}from"react/jsx-runtime";import{createElement as D,forwardRef as I,useCallback as r,useEffect as C,useImperativeHandle as L,useMemo as a,useRef as O,useState as W}from"react";import{createRoot as Y}from"react-dom/client";import F from"../../common/hook/useClickOutside";const p={wrapper:"k-drop-holder__anchor__wrapper",container:"k-drop-holder__anchor__container"},k=I(({id:b,className:c,style:i,...v},w)=>{const{content:d,children:_,onClick:E,offset:l="4px",position:e="bottom-center"}={...v},s=O(null),[f,n]=W(!1);F(s,()=>{n(!1)});const R=a(()=>{const t=[];return c&&t.push(c),e&&t.push(`k-drop-holder--${e}`),t.join(" ")},[c,e]),H=a(()=>i||{},[i]),P=r(()=>{const{width:t,height:o}=s.current?.getBoundingClientRect()??{width:0,height:0};return e==="top-left"?{transform:`translateY(calc(-100% - ${o}px)) translateX(0)`}:e==="top-center"?{transform:`translateY(calc(-100% - ${o}px)) translateX(calc(-50% + ${t/2}px))`}:e==="top-right"?{transform:`translateY(calc(-100% - ${o}px)) translateX(calc(-100% + ${t}px)`}:e==="bottom-left"?{transform:"translateX(0)"}:e==="bottom-center"?{transform:`translateX(calc(-50% + ${t/2}px))`}:e==="bottom-right"?{transform:`translateX(calc(-100% + ${t}px)`}:{transform:`translateX(calc(-50% + ${t/2}px))`}},[e]),X=r(()=>{n(!0),E?.()},[]),A=r(t=>{(t.key===" "||t.key==="Enter")&&n(!0)},[]),K=r(t=>{t.stopPropagation()},[]),u=a(()=>g(B,{children:d}),[d]),S=r(()=>{n(!0)},[]),m=r(()=>{n(!1)},[]),h=r(t=>{const{top:o,left:z,height:$}=s.current?.getBoundingClientRect()||{top:0,left:0,height:0};t.style.setProperty("position","fixed"),t.style.setProperty("zIndex","9999"),e?.includes("bottom")&&t.style.setProperty("top",`calc(${o+$}px + ${l})`),e?.includes("top")&&t.style.setProperty("top",`calc(${o+$}px - ${l})`),t.style.setProperty("left",`${z}px`)},[e,l]),y=r(()=>{m()},[]),j=r(()=>{const t=document.createElement("div");t.classList.add(p.wrapper),h(t),document.body.appendChild(t);const o=D("div",{className:p.container,style:P(),onClick:K},u);Y(t).render(o),window.addEventListener("scroll",y,{passive:!0})},[u,h]),x=r(()=>{document.body.getElementsByClassName(p.wrapper)[0]?.remove(),window.removeEventListener("scroll",y)},[]);return C(()=>{f?j():x()},[f]),C(()=>()=>x(),[]),L(w,()=>({open:S,close:m})),g("div",{ref:s,id:b,className:`k-drop-holder ${R}`,tabIndex:0,role:"button",onClick:X,onKeyUp:A,style:H,children:_})});k.displayName="KDropHolder";export default k;
