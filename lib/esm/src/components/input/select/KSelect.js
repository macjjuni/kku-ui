"use strict";import{jsx as u,jsxs as $}from"react/jsx-runtime";import{forwardRef as q,useCallback as t,useImperativeHandle as A,useMemo as m,useRef as x,useState as G}from"react";import{initDisabled as J,initSize as P}from"../../../common/util/variation";import{KIcon as Q}from"../../../components";import V from"../../../components/input/select/KSelectList";import{useCleanId as W}from"../../../common/hook/useCleanId";const K=q(({...C},I)=>{const{id:R,className:f,style:k,items:l,onBlur:v,noDataText:S,onFocus:w,size:y,width:_,onChange:a,value:c,placeholder:d,disabled:r}={...C},L=x(null),n=x(!1),[o,b]=G(!1),N=W("k-select-list"),M=m(()=>{const e=[];return o&&e.push("k-select--open"),f&&e.push(f),P(e,"k-select",y),J(e,"k-select",r),e.join(" ")},[o,f,y,r]),T=m(()=>({..._?{width:_}:{},...k}),[k]),p=t(()=>{b(!0)},[]),s=t(()=>{b(!1)},[]),j=m(()=>{if((!c||c==="")&&d)return u("span",{className:"k-select__label-text__placeholder",children:d});const e=l?.find(i=>i.value===c);return u("span",{className:"k-select__label-text",children:e?.title||c})},[c,l,d]),z=t(()=>{if(!o&&!r){p();return}s()},[o,r]),D=t(()=>{w?.()},[]),F=t(()=>{o&&!n.current&&s(),v?.()},[]),E=t(()=>{n.current=!0},[]),B=t(()=>{n.current=!1},[]),O=t(e=>{if(e.key==="Enter"||e.key===" "){if(!o){p();return}s()}e.key==="Tab"&&e.shiftKey&&n.current&&s(),e.key==="Tab"&&(n.current=!0)},[o]),g=t(e=>{e!==null&&(a(e.value),s())},[a]),U=t(()=>{n.current=!1},[]),H=t((e,i,h)=>{i&&(e.key==="Enter"||e.key===" ")&&a(i.value),(l.length-1===h||h===-1)&&!e.shiftKey&&e.key==="Tab"&&s()},[a,l]);return A(I,()=>({open:p,close:s})),$("div",{ref:L,id:R,className:`k-select ${M}`,style:T,tabIndex:r?-1:0,role:"button",onClick:z,onKeyUp:O,onFocus:D,onBlur:F,onMouseEnter:E,onMouseLeave:B,"aria-expanded":o,children:[j,u(Q,{className:"k-select__current__label__arrow-icon",icon:"keyboard_arrow_down",size:16}),u(V,{id:N,open:o,items:l,onClick:g,onFocus:U,onKeyDown:H,noDataText:S||"No Data"})]})});K.displayName="KSelect";export default K;
